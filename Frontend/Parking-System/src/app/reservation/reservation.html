<div class="max-w-md mx-auto mt-10 p-6 bg-white rounded-lg shadow-md">

    <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Vehicle Reservation Form</h2>
    <form #form="ngForm" (ngSubmit)="onSubmit()">
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2">Vehicle Number</label>
            <input type="text"
            class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
            [class.border-red-500]="validationErrors['vehicleNumber']"
            placeholder="Enter Vehicle Number"
            name="vehicleNumber"
            [(ngModel)]="vehicle.vehicleNumber"
            required            
            />
            @if (validationErrors['vehicleNumber']) {
              <p class="text-red-500 text-sm mt-1">{{ validationErrors['vehicleNumber'] }}</p>
            }
        </div>
        <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2">Vehicle type</label>
            <select [(ngModel)]="vehicle.vehicleType" name="vehicleType" required 
            [class.border-red-500]="validationErrors['vehicleType']"
            class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="" selected disabled>Select Vehicle Type</option>
                <option *ngFor="let type of vehicleTypes" [value]="type">{{type}}</option>
            </select>
            @if (validationErrors['vehicleType']) {
              <p class="text-red-500 text-sm mt-1">{{ validationErrors['vehicleType'] }}</p>
            }
        </div>
             <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2">Parking Lot</label>
            @defer (on timer(1s)) {
            <select [(ngModel)]="vehicle.parkingLotId" name="parkingLotId" required 
            [class.border-red-500]="validationErrors['parkingLotId']"
            class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="" selected disabled>Select Parking Lot</option>
                <option *ngFor="let type of parkingLots" [value]="type.id">{{type.name}}</option>
            </select>
        }@placeholder {
            <p class="p-3.5 font-bold text-gray-500 text-center">Loading parking lots...</p>
        }
            @if (validationErrors['parkingLotId']) {
              <p class="text-red-500 text-sm mt-1">{{ validationErrors['parkingLotId'] }}</p>
            }
        </div>
        <div class="flex gap-4">
                <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-blue-500">Submit Button</button>
    
                <button (click)="onBack()" type="button" class="bg-gray-800 hover:bg-gray-900 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-gray-500">Back Button</button> </div>
    </form>
</div>
@defer (on timer(1s)) {
<div class="max-w-4xl mx-auto mt-10 bg-white rounded-lg shadow-md overflow-hidden pb-5">
    <h2 class="text-2xl font-bold p-6 text-gray-800 border-b">Registered Parking Lots</h2>
    <div class="overflow-x-auto">
        <table class="min-w-full bg-white">
            <thead class="bg-gray-800 text-white">
                <tr>
                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Vehicle Number</th>
                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Parking Lot Name</th>
                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Reservation Time</th>
                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Expiration Time</th>
                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Status</th>
                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left">Actions</th>

                    <th class="py-3 px-4 uppercase font-semibold text-sm text-left"></th>
                </tr>
            </thead>
            <tbody class="text-gray-700" *ngIf="reservation && reservation.length > 0; else noData">
                <tr *ngFor="let lot of reservation" class="border-b hover:bg-gray-100">
                    <td class="py-3 px-4 text-left">{{ lot.vehicleNumber }}</td>
                    <td class="py-3 px-4 text-left">{{ lot.parkingLotName }}</td>
                    <td class="py-3 px-4 text-left">{{ lot.reservationTime }}</td>
                    <td class="py-3 px-4 text-left">{{ lot.expirationTime }}</td>
                    <td class="py-3 px-4 text-left">{{ lot.status }}</td>
                    @if(lot.status === 'ACTIVE') {
                    <td class="py-3 px-4 text-left"><button class="bg-blue-500 rounded-2xl p-2.5 border-2 text-white border-black" type="button" (click)="onArrival(lot.id)" >Mark as Arrived</button>
                     <button class="bg-green-500 rounded-2xl p-2.5 border-2 text-white border-black" type="button" (click)="onCancleReservation(lot.id)" >Cancel Reservation</button></td>
                    }
                   @else {
                        <td class="py-3 px-4 text-left">No Actions Available</td>
                    }
                </tr>
            </tbody>
            <ng-template #noData>
                <p class="p-6 text-center">No Reservations available</p>
            </ng-template>
        </table>
    </div>
</div>
} @placeholder {
    <p class="text-center mt-10 text-gray-500">Loading reservations table...</p>
}
